---
title: "Table creator"
author: "Patrizia Maier"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  bookdown::word_document2:
    fig_caption: yes
    global_numbering: TRUE
    number_sections: TRUE
---

```{r setup, include=FALSE, cache=FALSE}

knitr::read_chunk('Script_02_Analyzer.R')
knitr::opts_chunk$set(warning=FALSE, message=FALSE) 
options(knitr.kable.NA='')
```

```{r, load_analysis_packages, include=FALSE, cache=FALSE}
```

```{r, include=FALSE}
file_name <- "../WP10_data/WP10_results/wp10_navigation_data.RData"
load(file_name)
sm_orig <- sm_data 
sm_data <- sm_data %>% filter(exclude_trial_matlab==0)
rm(file_name)
```

```{r, data_prep, include=FALSE}
```

```{r, plot_settings, include=FALSE}
```

```{r, analysis_settings, include=FALSE}
```

```{r, papaja_output_helper, include=FALSE}
```

# Learning session

```{r, model_probe_ms, include=F  }
```

```{r, fixef_probe_ms, include=F  }
```

```{r, ranef_probe_ms, include=F  }
```

```{r apa_probe_ms, include=F}

# fixed effects
apa_lmm.ms <- apa_print(model.ms)

apa_omega.ms <- omega.ms$Omega2_partial %>% apa_num()

apa_ms_fixed <- apa_lmm.ms$table %>% 
  list_modify("omega"=apa_omega.ms) %>% label_variable(omega="$\\omega^2$")

# random effects
apa_LRT.ms <- tibble("Grouping" = c("Id", "Id", "Id")) %>% 
  cbind("Random effect" = c("(Intercept)", "Condition1", "(Intercept) X Condition1")) %>% 
  cbind("p.value" = c(NA, LRT.ms$p %>% apa_p(), NA)) 

apa_ms_random <- apa_random_table(VarCorr(model.ms$full_model), apa_LRT.ms) 


rm(apa_lmm.ms, omega.ms, apa_omega.ms, LRT.ms, apa_LRT.ms, model.ms)
```

```{r, model_learn_latency, include=F }
```

```{r, fixef_learn_latency, include=F  }
```

```{r, ranef_learn_latency, include=F  }
```

```{r apa_learn_latency, include=F}

# fixed effects 
apa_lmm.latency_learn  <- apa_print(model.latency_learn)

apa_omega.latency_learn <- omega.latency_learn$Omega2_partial %>% apa_num()

apa_latency_learn_fixed <- apa_lmm.latency_learn$table %>% 
  list_modify("omega"=apa_omega.latency_learn) %>% label_variable(omega="$\\omega^2$")

# # random effects
# apa_LRT.latency_learn <- tibble("Grouping" = c("Id", "Id", "Id")) %>% 
#   cbind("Random effect" = c("(Intercept)", "Condition1", "(Intercept) X Condition1")) %>% 
#   cbind("p.value" = c(NA, LRT.latency_learn$p %>% apa_p(), NA)) 
# 
# apa_latency_learn_random <- apa_random_table(VarCorr(model.latency_learn_learn$full_model), apa_LRT.latency_learn)
  

rm(apa_lmm.latency_learn, omega.latency_learn, apa_omega.latency_learn, LRT.latency_learn, apa_LRT.latency, model.latency_learn_learn)
```

```{r, model_learn_path, include=F  }
```

```{r, fixef_learn_path, include=F  }
```

```{r, ranef_learn_path, include=F  }
```

```{r apa_learn_path, include=F}

# fixed effects 
apa_lmm.path_learn <- apa_print(model.path_learn)

apa_omega.path_learn <- omega.path_learn$Omega2_partial %>% apa_num()

apa_path_learn_fixed <- apa_lmm.path_learn$table %>% 
  list_modify("omega"=apa_omega.path_learn) %>% label_variable(omega="$\\omega^2$")

# # random effects
# apa_LRT.path_learn <- tibble("Grouping" = c("Id", "Id", "Id")) %>% 
#   cbind("Random effect" = c("(Intercept)", "Condition1", "(Intercept) X Condition1")) %>% 
#   cbind("p.value" = c(NA, LRT.path_learn$p %>% apa_p(), NA)) 
# 
# apa_path_learn_random <- apa_random_table(VarCorr(model.path_learn$full_model), apa_LRT.path_learn) 


rm(apa_lmm.path_learn, omega.path_learn, apa_omega.path_learn, LRT.path_learn, apa_LRT.path_learn, model.path_learn)
```

```{r, model_learn_distance, include=F  }
```

```{r, fixef_learn_distance, include=F  }
```

```{r, ranef_learn_distance, include=F  }
```

```{r apa_learn_distance, include=F}

# fixed effects 
apa_lmm.distance_learn <- apa_print(model.distance_learn)

apa_omega.distance_learn <- omega.distance_learn$Omega2_partial %>% apa_num()

apa_distance_learn_fixed <- apa_lmm.distance_learn$table %>% 
  list_modify("omega"=apa_omega.distance_learn) %>% label_variable(omega="$\\omega^2$")

# # random effects
# apa_LRT.distance_learn <- tibble("Grouping" = c("Id", "Id", "Id")) %>% 
#   cbind("Random effect" = c("(Intercept)", "Condition1", "(Intercept) X Condition1")) %>% 
#   cbind("p.value" = c(NA, LRT.distance_learn$p %>% apa_p(), NA)) 
# 
# apa_distance_learn_random <- apa_random_table(VarCorr(model.distance_learn$full_model), apa_LRT.distance_learn) 


rm(apa_lmm.distance_learn, omega.distance_learn, apa_omega.distance_learn, LRT.distance_learn, apa_LRT.distance_learn, model.distance_learn)
```

```{r, model_learn_initial_rotation, include=F  }
```

```{r, fixef_learn_initial_rotation, include=F  }
```

```{r, ranef_learn_initial_rotation, include=F  }
```

```{r apa_learn_initial_rotation, include=F }

# fixed effects
apa_lmm.initial_rotation_learn <- apa_print(model.initial_rotation_learn)

apa_omega.initial_rotation_learn <- omega.initial_rotation_learn$Omega2_partial %>% apa_num()

apa_initial_rotation_learn_fixed <- apa_lmm.initial_rotation_learn$table %>% 
  list_modify("omega"=apa_omega.initial_rotation_learn) %>% label_variable(omega="$\\omega^2$")

# # random effects
# apa_LRT.initial_rotation_learn <- tibble("Grouping" = c("Id", "Id", "Id")) %>% 
#   cbind("Random effect" = c("(Intercept)", "Condition1", "(Intercept) X Condition1")) %>% 
#   cbind("p.value" = c(NA, LRT.initial_rotation_learn$p %>% apa_p(), NA)) 
# 
# apa_initial_rotation_learn_random <- apa_random_table(VarCorr(model.initial_rotation_learn$full_model), apa_LRT.initial_rotation_learn) 


rm(apa_lmm.initial_rotation_learn, omega.initial_rotation_learn, apa_omega.initial_rotation_learn, LRT.initial_rotation_learn, apa_LRT.initial_rotation_learn, model.initial_rotation_learn)
```

```{r apa_table_fixed, echo=F}
apa_table(
  cbind(apa_latency_learn_fixed,
        apa_path_learn_fixed %>% list_modify("term"=NULL), 
        apa_distance_learn_fixed %>% list_modify("term"=NULL), 
        apa_initial_rotation_learn_fixed %>% list_modify("term"=NULL))
  )

rm(apa_latency_learn_fixed, apa_path_learn_fixed, apa_distance_learn_fixed, apa_initial_rotation_learn_fixed)
```

\newpage

```{r, apa_table_random, echo=F }
# apa_table(
#   cbind(apa_ms_random,
#         apa_latency_random %>% list_modify("Grouping"=NULL, "Random effect"=NULL),
#         apa_path_random %>% list_modify("Grouping"=NULL, "Random effect"=NULL),
#         apa_distance_random %>% list_modify("Grouping"=NULL, "Random effect"=NULL),
#         apa_initial_rotation_random %>% list_modify("Grouping"=NULL, "Random effect"=NULL))
# )
# 
# rm(apa_ms_random, apa_latency_random, apa_path_random, apa_distance_random, apa_initial_rotation_random)
```

\newpage

# Long-term memory after consolidation period 

```{r, model_probe_ms_all, include=F  }
```

```{r, fixef_probe_ms_all, include=F  }
```

```{r, ranef_probe_ms_all, include=F  }
```

```{r apa_probe_ms_all, include=F}

# fixed effects 
apa_lmm.ms_all <- apa_print(model.ms_all)

apa_omega.ms_all <- omega.ms_all$Omega2_partial %>% apa_num()

apa_ms_all_fixed <- apa_lmm.ms_all$table %>% 
  list_modify("omega"=apa_omega.ms_all) %>% label_variable(omega="$\\omega^2$")

# random effects
apa_LRT.ms_all <- tibble("Grouping" = c("Id", "Id", "Id", "Id", "Id", "Id")) %>% 
  cbind("Random effect" = c("(Intercept)",  "Session1", "Condition1", 
                            "(Intercept) X Session1", "(Intercept) X Condition1", "Session1 X Condition1")) %>% 
  cbind("p.value" = c(NA, LRT.ms_all_session$p %>% apa_p(), LRT.ms_all_condition$p %>% apa_p(), NA, NA, NA)) 

apa_ms_all_random <- apa_random_table(VarCorr(model.ms_all$full_model), apa_LRT.ms_all) 


rm(apa_lmm.ms_all, omega.ms_all , apa_omega.ms_all, LRT.ms_all_session, LRT.ms_all_condition, apa_LRT.ms_all, model.ms_all)
```

```{r apa_table_fixed_all, echo=F}
apa_table(
  apa_ms_all_fixed
)

rm(apa_ms_all_fixed)
```

```{r apa_table_random_all, echo=F}
apa_table(
  apa_ms_all_random
)

rm(apa_ms_all_random)
```

\newpage

```{r, model_probe_ms_wl, include=F  }
```

```{r, fixef_probe_ms_wl, include=F  }
```

```{r, ranef_probe_ms_wl, include=F  }
```

```{r apa_probe_ms_wl, include=F}

# fixed effects 
apa_lmm.ms_wl <- apa_print(model.ms_wl)

apa_omega.ms_wl <- omega.ms_wl$Omega2_partial %>% apa_num()

apa_ms_wl_fixed <- apa_lmm.ms_wl$table %>% 
  list_modify("omega"=apa_omega.ms_wl) %>% label_variable(omega="$\\omega^2$")

# random effects 
apa_LRT.ms_wl <- tibble("Grouping" = c("Id", "Id", "Id")) %>% 
  cbind("Random effect" = c("(Intercept)", "Session1", "(Intercept) X Session1")) %>% 
  cbind("p.value" = c(NA, LRT.ms_wl$p %>% apa_p(), NA)) 

apa_ms_wl_random <- apa_random_table(VarCorr(model.ms_wl$full_model), apa_LRT.ms_wl) 


rm(apa_lmm.ms_wl, omega.ms_wl , apa_omega.ms_wl, LRT.ms_wl, apa_LRT.ms_wl, model.ms_wl)
```

```{r apa_table_fixed_wl, echo=F}
apa_table(
  apa_ms_wl_fixed
  )

rm(apa_ms_wl_fixed)
```

```{r apa_table_random_wl, echo=F}
apa_table(
  apa_ms_wl_random
  )

rm(apa_ms_wl_random)
```
